---
title: "Heteroplasmy and mortality - TOPMed"
subtitle: "Meta-analysis"
author: "Yun Soo Hong"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: 
  html_document:
    toc: true
    toc_float: 
      collapsed: false
      smooth_scroll: false
    pandoc_args: [
    "--number-sections",
    "--number-offset=0"
    ]
fontsize: 11pt
---

# Set up  

## Program description  
* This program reads in the data sets.     
  * Step 1: Read in data 
    * `input/ukb_het_mortality_all_cohorts_summary_by_race_to19_2023_02_27.xlsx`  
  * Step 2: Forest plots    
  * Step 3: Meta-analysis  

## Versions of R and packages  
```{r analysis_09 set up, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries
```{r analysis_09 load libraries, echo = TRUE, message = FALSE}
library(tidyverse)
library(magrittr)
library(lubridate)
library(data.table)
library(rms)
library(RColorBrewer)
library(forestploter)
# library(dmetar)
library(meta)
library(metafor)
# library(esc)
```

## Print out settings  
```{r analysis_09 print settings}
options(tibble.print_max = 100)
options(pillar.sigfig = 5)
```

# Load data 
## het_count data  
```{r analysis load het_count data}
het_count <- readxl::read_excel(
  "../input/ukb_het_mortality_all_cohorts_summary_by_race_to19_2023_02_27.xlsx", 1
)

het_count %<>%
  mutate(
    coef = round(as.numeric(coef), 3),
    lci = round(as.numeric(lci), 3),
    uci = round(as.numeric(uci), 3)
    )

# for meta-analysis
ma_hc <- readxl::read_excel(
  "../input/ukb_het_mortality_all_cohorts_meta_analysis_to19_2023_02_27.xlsx", 1
) %>%
  mutate(
    hr = exp(loghr),
    lower = exp(loghr - 1.96*logse),
    upper = exp(loghr + 1.96*logse)
  )
```

## MSS data   
```{r analysis load mss data}
mss <- readxl::read_excel(
  "../input/ukb_het_mortality_all_cohorts_summary_by_race_to19_2023_02_27.xlsx", 2
)

mss %<>%
  mutate(
    coef = round(as.numeric(coef), 3),
    lci = round(as.numeric(lci), 3),
    uci = round(as.numeric(uci), 3)
    )

# for meta-analysis
ma_mss <- readxl::read_excel(
  "../input/ukb_het_mortality_all_cohorts_meta_analysis_to19_2023_02_27.xlsx", 2
) %>%
  mutate(
    hr = exp(loghr),
    lower = exp(loghr - 1.96*logse),
    upper = exp(loghr + 1.96*logse)
  )
```

## het_count and MSS data  
```{r analysis_09 load het_count_mss data}
hc_mss <- readxl::read_excel(
  "../input/ukb_het_mortality_all_cohorts_summary_by_race_to19_2023_02_27.xlsx", 3
)

hc_mss %<>%
  mutate(
    coef1 = round(as.numeric(coef1), 3),
    lci1 = round(as.numeric(lci1), 3),
    uci1 = round(as.numeric(uci1), 3),
    coef2 = round(as.numeric(coef2), 3),
    lci2 = round(as.numeric(lci2), 3),
    uci2 = round(as.numeric(uci2), 3)
    )

# for meta-analysis
ma_hc_mss <- readxl::read_excel(
  "../input/ukb_het_mortality_all_cohorts_meta_analysis_to19_2023_02_27.xlsx", 3
) %>%
  mutate(
    hr_hc = exp(loghr_hc),
    lower_hc = exp(loghr_hc - 1.96*logse_hc),
    upper_hc = exp(loghr_hc + 1.96*logse_hc),
    hr_mss = exp(loghr_mss),
    lower_mss = exp(loghr_mss - 1.96*logse_mss),
    upper_mss = exp(loghr_mss + 1.96*logse_mss)
  )
```

# Extended figure 6: Meta-analysis, overall (not including UKB)  
## Heteroplasmy count  
```{r analysis_09 ma hc overall}
ma_hc_overall <- ma_hc %>%
  filter(subgroup == "overall" & cohort != "ukb" & cohort != "chs") 

res_hc_overall <- rma(loghr, sei = logse, data = ma_hc_overall, method = "FE")
summary(res_hc_overall)
metafor::forest(res_hc_overall,
                slab = paste0(ma_hc_overall$cohort),
                atransf = exp,
                at = log(c(1, 1.04, 1.08, 1.12)), 
                header = TRUE,
                showweights = TRUE)

ma_hc_overall_re <- ma_hc_overall %>%
  add_row(
    cohort = "summary", 
    subgroup = "overall", 
    loghr = 0.0404,
    logse = 0.0109,
    total = NA,
    event = NA,
    hr = 1.04,
    lower = 1.02,
    upper = 1.06) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "Overall"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Overall",
      TRUE ~ ""
    )
  )

ma_hc_overall_plot <- ma_hc_overall_re %>%
  filter(group != "Overall") %>%
  mutate(
    lci = loghr - 1.96*logse, 
    uci = loghr + 1.96*logse,
    ` ` = paste(rep(" ", 30), collapse = ""),
    `HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr, lower, upper),
    total = as.character(total),
    event = as.character(event)
  ) %>%
  mutate(
    cohort = case_when(
      row == 1 ~ "",
      cohort == "aric" ~ "ARIC",
      cohort == "mesa" ~ "MESA",
      cohort == "fhs" ~ "FHS",
      # cohort == "chs" ~ "CHS", 
      cohort == "whi" ~ "WHI", 
      cohort == "summary" ~ "Summary"
    ),
    `HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `HR (95% CI)`
    ),
    total = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ total
    ),
    event = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ event
    )
  ) %>%
  dplyr::select(cohort, total, event, ` `, `HR (95% CI)`, everything()) %>%
  rename(
    Total = total,
    Events = event,
    Cohort = cohort
  )

hc_overall <- forestploter::forest(
  ma_hc_overall_plot[, c(1:5)],
  est = ma_hc_overall_plot$hr, 
  lower = ma_hc_overall_plot$lower,
  upper = ma_hc_overall_plot$upper,
  sizes = 0.6,
  ci_column = 4,
  ref_line = 1,
  xlim = c(0.85, 1.2), 
  ticks_at = c(0.9, 1, 1.1, 1.2),
  x_trans = "log",
  title = "Heteroplasmy count"
  )  

hc_overall_a <- edit_plot(hc_overall,
          row = 5,
          gp = grid::gpar(fontface = "bold"))
```

## Mitoscore  
```{r analysis_09 ma mss overall}
ma_mss_overall <- ma_mss %>%
  filter(subgroup == "overall" & cohort != "ukb" & cohort != "chs") 

res_mss_overall <- rma(loghr, sei = logse, data = ma_mss_overall, method = "FE")
summary(res_mss_overall)
metafor::forest(res_mss_overall, 
                slab = paste0(ma_mss_overall$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_mss_overall_re <- ma_mss_overall %>%
  add_row(
    cohort = "summary", 
    subgroup = "overall", 
    loghr = 0.1123,
    logse = 0.0296,
    total = NA,
    event = NA,
    hr = 1.12,
    lower = 1.06,
    upper = 1.19) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "Overall"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Overall",
      TRUE ~ ""
    )
  )

ma_mss_overall_plot <- ma_mss_overall_re %>%
  filter(group != "Overall") %>%
  mutate(
    lci = loghr - 1.96*logse, 
    uci = loghr + 1.96*logse,
    ` ` = paste(rep(" ", 30), collapse = ""),
    `HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr, lower, upper),
    total = as.character(total),
    event = as.character(event)
  ) %>%
  mutate(
    cohort = case_when(
      row == 1 ~ "",
      cohort == "aric" ~ "ARIC",
      cohort == "mesa" ~ "MESA",
      cohort == "fhs" ~ "FHS",
      # cohort == "chs" ~ "CHS", 
      cohort == "whi" ~ "WHI", 
      cohort == "summary" ~ "Summary"
    ),
    `HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `HR (95% CI)`
    ),
    total = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ total
    ),
    event = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ event
    )
  ) %>%
  dplyr::select(cohort, total, event, ` `, `HR (95% CI)`, everything()) %>%
  rename(
    Total = total,
    Events = event,
    Cohort = cohort
  )

mss_overall <- forestploter::forest(
  ma_mss_overall_plot[, c(1:5)],
  est = ma_mss_overall_plot$hr, 
  lower = ma_mss_overall_plot$lower,
  upper = ma_mss_overall_plot$upper,
  sizes = 0.6,
  ci_column = 4,
  ref_line = 1,
  xlim = c(0.90, 1.75), 
  ticks_at = c(0.9, 1, 1.25, 1.5, 1.75), 
  x_trans = "log",
  title = "MSS"
  )  

mss_overall_a <- edit_plot(mss_overall,
          row = 5,
          gp = grid::gpar(fontface = "bold"))
```

## Heteroplasmy count and Mitoscore  
```{r analysis_09 ma hc_mss overall}
ma_hc_mss_overall <- ma_hc_mss %>%
  filter(subgroup == "overall" & cohort != "ukb" & cohort != "chs") 

# coefficients for het_count
res_hc_mss_overall_hc <- rma(loghr_hc, sei = logse_hc, data = ma_hc_mss_overall, method = "FE")
summary(res_hc_mss_overall_hc)
metafor::forest(res_hc_mss_overall_hc, 
                slab = paste0(ma_hc_mss_overall$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

# coefficients for mss
res_hc_mss_overall_mss <- rma(loghr_mss, sei = logse_mss, data = ma_hc_mss_overall, method = "FE")
summary(res_hc_mss_overall_mss)
metafor::forest(res_hc_mss_overall_mss, 
                slab = paste0(ma_hc_mss_overall$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_mss_overall_re <- ma_hc_mss_overall %>%
  add_row(
    cohort = "summary", 
    subgroup = "overall", 
    loghr_hc = 0.0238,
    logse_hc = 0.0146,
    loghr_mss = 0.0711,
    logse_mss = 0.0399,
    total = NA,
    event = NA,
    hr_hc = 1.02,
    lower_hc = 1.00,
    upper_hc = 1.05,
    hr_mss = 1.07,
    lower_mss = 0.99,
    upper_mss = 1.16) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "Overall"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Overall",
      TRUE ~ ""
    )
  )

hc_mss_overall_plot <- ma_hc_mss_overall_re %>%
  filter(group != "Overall") %>%
  mutate(
    # estimates for het_count
    lci_hc = loghr_hc - 1.96*logse_hc, 
    uci_hc = loghr_hc + 1.96*logse_hc,
    hc = paste(rep(" ", 30), collapse = ""),
    `Heteroplasmy count HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr_hc, lower_hc, upper_hc),
    # estimates for mss
    lci_mss = loghr_mss - 1.96*logse_mss, 
    uci_mss = loghr_mss + 1.96*logse_mss,
    mss = paste(rep(" ", 30), collapse = ""),
    `MSS HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr_mss, lower_mss, upper_mss),
    total = as.character(total),
    event = as.character(event)
  ) %>%
  mutate(
    cohort = case_when(
      row == 1 ~ "",
      cohort == "aric" ~ "ARIC",
      cohort == "mesa" ~ "MESA",
      cohort == "fhs" ~ "FHS",
      # cohort == "chs" ~ "CHS",
      cohort == "whi" ~ "WHI",      
      cohort == "summary" ~ "Summary"
    ),
    `Heteroplasmy count HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `Heteroplasmy count HR (95% CI)`
    ),
    `MSS HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `MSS HR (95% CI)`
    ),
    total = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ total
    ),
    event = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ event
    )
  ) %>%
  dplyr::select(cohort, total, event, hc, `Heteroplasmy count HR (95% CI)`, mss, `MSS HR (95% CI)`, everything()) %>%
  rename(
    Total = total,
    Events = event,
    Cohort = cohort, 
    ` ` = hc,
    `  ` = mss
  )

hc_mss_overall <- forestploter::forest(
  hc_mss_overall_plot[, c(1:7)],
  est = list(hc_mss_overall_plot$hr_hc, hc_mss_overall_plot$hr_mss), 
  lower = list(hc_mss_overall_plot$lower_hc, hc_mss_overall_plot$lower_mss),
  upper = list(hc_mss_overall_plot$upper_hc, hc_mss_overall_plot$upper_mss),
  sizes = 0.6,
  ci_column = c(4, 6),
  ref_line = c(1, 1),
  xlim = list(
    c(0.85, 1.2),
    c(0.85, 1.85)
  ),
  ticks_at = list(
    c(0.9, 1, 1.1, 1.2),
    c(0.9, 1, 1.25, 1.5, 1.75)
  ),
  x_trans = "log",
  title = "Heterplasmy count and MSS"
  )  

hc_mss_overall_a <- edit_plot(hc_mss_overall,
          row = 5,
          gp = grid::gpar(fontface = "bold"))
```

```{r, fig.height = 6, fig.width = 12}
ext_fig6 <- ggpubr::ggarrange(
  ggpubr::ggarrange(hc_overall_a, mss_overall_a, nrow = 1, labels = c("a", "b")), 
  hc_mss_overall_a,
  nrow = 2, 
  labels = c("", "c"),
  widths = c(0.5, 1)
)
ext_fig6

ggsave("ukb_heteroplasmy_outcomes_extended_fig6.tiff", ext_fig6)
```

# Extended figure 7: Forest plots by race      
## `het_count`  
```{r analysis_09 forest het_count, fig.width=10, fig.height=10}
het_count_table <- het_count %>%
  mutate(
    ` ` = paste(rep(" ", 30), collapse = ""),
    `HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", coef, lci, uci),
    cohort = case_when(
      race != "" ~ "",
      TRUE ~ cohort
      ),
    race = case_when(
      cohort != "" ~ "",
      TRUE ~ race
      ),
    total = as.character(total),
    total = case_when(
      cohort != "" ~ "",
      TRUE ~ total
      ),
    event = as.character(event),
    event = case_when(
      cohort != "" ~ "",
      TRUE ~ event
      ),
    `HR (95% CI)` = case_when(
      cohort != "" ~ "",
      TRUE ~ `HR (95% CI)`
      )
    ) %>%
  rename(Events = event,
         Total = total,
         Cohort = cohort,
         Race = race) %>%
  dplyr::select(Cohort, Race, Total, Events, ` `, `HR (95% CI)`, everything())

hc_plot <- forestploter::forest(
  het_count_table[, c(1:6)],
  est = het_count_table$coef,
  lower = het_count_table$lci,
  upper = het_count_table$uci,
  sizes = 0.6,
  ci_column = 5,
  ref_line = 1,
  xlim = c(0.85, 1.5),
  ticks_at = c(0.9, 1, 1.25, 1.5),
  x_trans = "log",
  title = "Heteroplasmy count"
  )  

hc_plot <- edit_plot(
  hc_plot,
  row = c(2, 6, 12, 15, 19, 26),
  col = 5, 
  which = "ci",
  gp = grid::gpar(col = "blue"))

edit_plot(
  hc_plot,
  row = c(4, 8, 17, 21, 28),
  col = 5, 
  which = "ci",
  gp = grid::gpar(col = "red"))

het_count_table_ukb <- het_count_table[c(25:30), ]

het_count_table_ukb %<>%
  filter(Cohort != "UKB") %>%
  dplyr::select(!Cohort) %>%
  mutate(
    Race = case_when(
      Race == "overall" ~ "Overall",
      TRUE ~ Race
    )
  )

hc_plot_ukb <- forestploter::forest(
  het_count_table_ukb[, c(1:5)],
  est = het_count_table_ukb$coef,
  lower = het_count_table_ukb$lci,
  upper = het_count_table_ukb$uci,
  sizes = 0.6,
  ci_column = 4,
  ref_line = 1,
  xlim = c(0.80, 1.5),
  ticks_at = c(0.8, 1, 1.25, 1.5),
  x_trans = "log",
  title = "Heteroplasmy count"
  )  
hc_plot_ukb_a <- edit_plot(
  hc_plot_ukb,
  row = 1,
  gp = grid::gpar(fontface = "bold"))
```

## `mito_score_sum_lc`  
```{r analysis_09 forest mss, fig.width=10, fig.height=10}
mss_table <- mss %>%
  mutate(
    ` ` = paste(rep(" ", 30), collapse = ""),
    `HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", coef, lci, uci),
    cohort = case_when(
      race != "" ~ "",
      TRUE ~ cohort
      ),
    race = case_when(
      cohort != "" ~ "",
      TRUE ~ race
      ),
    total = as.character(total),
    total = case_when(
      cohort != "" ~ "",
      TRUE ~ total
      ),
    event = as.character(event),
    event = case_when(
      cohort != "" ~ "",
      TRUE ~ event
      ),
    `HR (95% CI)` = case_when(
      cohort != "" ~ "",
      TRUE ~ `HR (95% CI)`
      )
    ) %>%
  rename(Events = event,
         Total = total,
         Cohort = cohort,
         Race = race) %>%
  dplyr::select(Cohort, Race, Total, Events, ` `, `HR (95% CI)`, everything())

mss_plot <- forestploter::forest(
  mss_table[, c(1:6)],
  est = mss$coef,
  lower = mss$lci,
  upper = mss$uci,
  sizes = 0.6,
  ci_column = 5,
  ref_line = 1,
  xlim = c(0.75, 3),
  ticks_at = c(0.75, 1, 1.5, 2, 3),
  x_trans = "log",
   title = "MSS"
  )  

mss_plot <- edit_plot(
  mss_plot,
  row = c(2, 6, 12, 15, 19, 26),
  col = 5, 
  which = "ci",
  gp = grid::gpar(col = "blue"))

edit_plot(
  mss_plot,
  row = c(4, 8, 17, 21, 28),
  col = 5, 
  which = "ci",
  gp = grid::gpar(col = "red"))

mss_table_ukb <- mss_table[c(25:30), ]

mss_table_ukb %<>%
  filter(Cohort != "UKB") %>%
  dplyr::select(!Cohort) %>%
  mutate(
    Race = case_when(
      Race == "overall" ~ "Overall",
      TRUE ~ Race
    )
  )

mss_plot_ukb <- forestploter::forest(
  mss_table_ukb[, c(1:5)],
  est = mss_table_ukb$coef,
  lower = mss_table_ukb$lci,
  upper = mss_table_ukb$uci,
  sizes = 0.6,
  ci_column = 4,
  ref_line = 1,
  xlim = c(0.50, 3),
  ticks_at = c(0.50, 1, 2, 3),
  x_trans = "log",
  title = "MSS"
  )  
mss_plot_ukb_a <- edit_plot(
  mss_plot_ukb,
  row = 1,
  gp = grid::gpar(fontface = "bold"))
```

## `het_count` and `mito_score_sum_lc`    
```{r analysis_09 forest hc_mss, fig.width=12, fig.height=10}
hc_mss_table <- hc_mss %>%
  mutate(
    # columns for het_count
    hc = paste(rep(" ", 30), collapse = ""),
    `Heteroplasmy count HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", coef1, lci1, uci1),
    # columns for mss 
    mss = paste(rep(" ", 30), collapse = ""),
    `MSS HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", coef2, lci2, uci2),
    cohort = case_when(
      race != "" ~ "",
      TRUE ~ cohort
      ),
    race = case_when(
      cohort != "" ~ "",
      TRUE ~ race
      ),
    total = as.character(total),
    total = case_when(
      cohort != "" ~ "",
      TRUE ~ total
      ),
    event = as.character(event),
    event = case_when(
      cohort != "" ~ "",
      TRUE ~ event
      ),
    `Heteroplasmy count HR (95% CI)` = case_when(
      cohort != "" ~ "",
      TRUE ~ `Heteroplasmy count HR (95% CI)`
      ), 
    `MSS HR (95% CI)` = case_when(
      cohort != "" ~ "",
      TRUE ~ `MSS HR (95% CI)`
      )
    ) %>%
  rename(Events = event,
         Total = total,
         Cohort = cohort,
         Race = race,
         ` ` = hc,
         `  ` = mss) %>%
  dplyr::select(Cohort, Race, Total, Events, ` `, `Heteroplasmy count HR (95% CI)`, `  `, `MSS HR (95% CI)`, everything())

hc_mss_plot <- forestploter::forest(
  hc_mss_table[, c(1:8)],
  est = list(hc_mss$coef1, hc_mss$coef2),
  lower = list(hc_mss$lci1, hc_mss$lci2),
  upper = list(hc_mss$uci1, hc_mss$uci2), 
  sizes = 0.6,
  ci_column = c(5, 7),
  ref_line = c(1, 1),
  xlim = list(
    c(0.75, 1.5),
    c(0.5, 3)
  ),
  ticks_at = list(
    c(0.75, 1, 1.25, 1.5),
    c(0.5, 0.75, 1, 1.5, 2, 3)
  ),
  x_trans = "log",
  title = "Heteroplasmy count and MSS"
  )  

hc_mss_plot <- edit_plot(
  hc_mss_plot, 
  row = c(2, 6, 12, 15, 19, 26),
  col = c(5, 7), 
  which = "ci",
  gp = grid::gpar(col = "blue"))

edit_plot(
  hc_mss_plot, 
  row = c(4, 8, 17, 21, 28),
  col = c(5, 7), 
  which = "ci",
  gp = grid::gpar(col = "red"))

hc_mss_table_ukb <- hc_mss_table[c(25:30), ]

hc_mss_table_ukb %<>%
  filter(Cohort != "UKB") %>%
  dplyr::select(!Cohort) %>%
  mutate(
    Race = case_when(
      Race == "overall" ~ "Overall",
      TRUE ~ Race
    )
  )

hc_mss_plot_ukb <- forestploter::forest(
  hc_mss_table_ukb[, c(1:7)],
  est = list(hc_mss_table_ukb$coef1, hc_mss_table_ukb$coef2),
  lower = list(hc_mss_table_ukb$lci1, hc_mss_table_ukb$lci2),
  upper = list(hc_mss_table_ukb$uci1, hc_mss_table_ukb$uci2), 
  sizes = 0.6,
  ci_column = c(4, 6),
  ref_line = c(1, 1),
  xlim = list(
    c(0.75, 1.5),
    c(0.5, 3)
  ),
  ticks_at = list(
    c(0.75, 1, 1.25, 1.5),
    c(0.5, 0.75, 1, 1.5, 2, 3)
  ),
  x_trans = "log",
  title = "Heteroplasmy count and MSS"
  )  

hc_mss_plot_ukb_a <- edit_plot(
  hc_mss_plot_ukb,
  row = 1,
  gp = grid::gpar(fontface = "bold"))
```

```{r, fig.height = 6, fig.width = 12}
ext_fig7 <- ggpubr::ggarrange(
  ggpubr::ggarrange(hc_plot_ukb_a, mss_plot_ukb_a, nrow = 1, labels = c("a", "b")), 
  hc_mss_plot_ukb_a,
  nrow = 2, 
  labels = c("", "c"),
  widths = c(0.5, 1)
)
ext_fig7

ggsave("ukb_heteroplasmy_outcomes_extended_fig7.tiff", ext_fig7)
```

# Extended figure 8: Meta-analysis by race including UKB  
## Heteroplasmy count 
### White 
```{r analysis_09 ma hc white ukb}
ma_hc_white <- ma_hc %>%
  filter(subgroup == "white" & cohort != "chs") 

res_hc_white <- rma(loghr, sei = logse, data = ma_hc_white, method = "FE")
summary(res_hc_white)
metafor::forest(res_hc_white, 
                slab = paste0(ma_hc_white$cohort),
                atransf = exp,
                at = log(c(1, 1.04, 1.08, 1.12)), 
                header = TRUE,
                showweights = TRUE)

ma_hc_white_re <- ma_hc_white %>%
  add_row(
    cohort = "summary", 
    subgroup = "white", 
    loghr = 0.0421,
    logse = 0.0087,
    total = NA,
    event = NA,
    hr = 1.04,
    lower = 1.03, 
    upper = 1.06) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "White"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "White",
      TRUE ~ ""
    )
  )
```

### Black  
```{r analysis_09 ma hc black ukb}
ma_hc_black <- ma_hc %>%
  filter(subgroup == "black"  & cohort != "chs") 

res_hc_black <- rma(loghr, sei = logse, data = ma_hc_black, method = "FE")
summary(res_hc_black)
metafor::forest(res_hc_black, 
                slab = paste0(ma_hc_black$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_black_re <- ma_hc_black %>%
  add_row(
    cohort = "summary", 
    subgroup = "black", 
    loghr = 0.0414,
    logse = 0.0290,
    total = NA,
    event = NA,
    hr = 1.04,
    lower = 0.98,
    upper = 1.10) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "Black"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Black",
      TRUE ~ ""
    )
  )
```

### Hispanics  
```{r analysis_09 ma hc hispanic ukb}
ma_hc_hispanic <- ma_hc %>%
  filter(subgroup == "hispanic" & cohort != "chs") 

res_hc_hispanic <- rma(loghr, sei = logse, data = ma_hc_hispanic, method = "FE")
summary(res_hc_hispanic)
metafor::forest(res_hc_hispanic, 
                slab = paste0(ma_hc_hispanic$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_hispanic_re <- ma_hc_hispanic %>%
  add_row(
    cohort = "summary", 
    subgroup = "hispanic", 
    loghr = 0.0343,
    logse = 0.0881,
    total = NA,
    event = NA,
    hr = 1.03,
    lower = 0.87,
    upper = 1.23) %>%  
  add_row(.before = 1) %>%
  mutate(
    group = "Hispanic"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Hispanic",
      TRUE ~ ""
    )
  )
```

### Asian  
```{r analysis_09 ma hc asian ukb}
ma_hc_asian <- ma_hc %>%
  filter(subgroup == "asian" & cohort != "chs") 

res_hc_asian <- rma(loghr, sei = logse, data = ma_hc_asian, method = "FE")
summary(res_hc_asian)
metafor::forest(res_hc_asian, 
                slab = paste0(ma_hc_asian$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_asian_re <- ma_hc_asian %>%
  add_row(
    cohort = "summary", 
    subgroup = "asian", 
    loghr = 0.1817,
    logse = 0.0705,
    total = NA,
    event = NA,
    hr = 1.21,
    lower = 1.05,
    upper = 1.39) %>%  
  add_row(.before = 1) %>%
  mutate(
    group = "Asian"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Asian",
      TRUE ~ ""
    )
  )
```

### Combined  
```{r analysis_09 ma hc combined ukb, fig.width=7.5, fig.height=8}
ma_hc_combined <- bind_rows(ma_hc_white_re, ma_hc_black_re, ma_hc_hispanic_re, ma_hc_asian_re) 

ma_hc_combined %<>%
  mutate(
    lci = loghr - 1.96*logse, 
    uci = loghr + 1.96*logse,
    ` ` = paste(rep(" ", 30), collapse = ""),
    `HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr, lower, upper),
    total = as.character(total),
    event = as.character(event)
  ) %>%
  mutate(
    cohort = case_when(
      row == 1 ~ "",
      cohort == "aric" ~ "ARIC",
      cohort == "mesa" ~ "MESA",
      cohort == "fhs" ~ "FHS",
      cohort == "chs" ~ "CHS",
      cohort == "whi" ~ "WHI",
      cohort == "ukb" ~ "UKB", 
      cohort == "summary" ~ "Summary"
    ),
    `HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `HR (95% CI)`
    ),
    total = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ total
    ),
    event = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ event
    )
  ) %>%
  dplyr::select(group, cohort, total, event, ` `, `HR (95% CI)`, everything()) %>%
  rename(
    Total = total,
    Events = event,
    Group = group,
    Cohort = cohort
  )

hc_combined <- forestploter::forest(
  ma_hc_combined[, c(1:6)],
  est = ma_hc_combined$hr, 
  lower = ma_hc_combined$lower,
  upper = ma_hc_combined$upper,
  sizes = 0.6,
  ci_column = 5,
  ref_line = 1,
  x_trans = "log",
  title = "Heteroplasmy count"
  )  

hc_combined_plot <- edit_plot(
  hc_combined,
  row = c(7, 13, 17, 22),
  col = 5, 
  which = "ci",
  gp = grid::gpar(col = "blue"))


hc_race_a <- edit_plot(hc_combined_plot,
          row = c(7, 13, 17, 22),
          gp = grid::gpar(fontface = "bold"))
hc_race_a
```

## Mitoscore  
### White 
```{r analysis_09 ma mss white ukb}
ma_mss_white <- ma_mss %>%
  filter(subgroup == "white" & cohort != "chs") 

res_mss_white <- rma(loghr, sei = logse, data = ma_mss_white, method = "FE")
summary(res_mss_white)
metafor::forest(res_mss_white, 
                slab = paste0(ma_mss_white$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_mss_white_re <- ma_mss_white %>%
  add_row(
    cohort = "summary", 
    subgroup = "white", 
    loghr = 0.1765,
    logse = 0.0237,
    total = NA,
    event = NA,
    hr = 1.19,
    lower = 1.14,
    upper = 1.25) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "white"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "White",
      TRUE ~ ""
    )
  )
```

### Black  
```{r analysis_09 ma mss black ukb}
ma_mss_black <- ma_mss %>%
  filter(subgroup == "black" & cohort != "chs") 

res_mss_black <- rma(loghr, sei = logse, data = ma_mss_black, method = "FE")
summary(res_mss_black)
metafor::forest(res_mss_black, 
                slab = paste0(ma_mss_black$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_mss_black_re <- ma_mss_black %>%
  add_row(
    cohort = "summary", 
    subgroup = "black", 
    loghr = -0.0175,
    logse = 0.0820,
    total = NA,
    event = NA,
    hr = 0.98,
    lower = 0.84,
    upper = 1.15) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "Black"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Black",
      TRUE ~ ""
    )
  )
```

### Hispanic  
```{r analysis_09 ma mss hispanic ukb}
ma_mss_hispanic <- ma_mss %>%
  filter(subgroup == "hispanic" & cohort != "chs") 

res_mss_hispanic <- rma(loghr, sei = logse, data = ma_mss_hispanic, method = "FE")
summary(res_mss_hispanic)
metafor::forest(res_mss_hispanic, 
                slab = paste0(ma_mss_hispanic$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_mss_hispanic_re <- ma_mss_hispanic %>%
  add_row(
    cohort = "summary", 
    subgroup = "hispanic", 
    loghr = 0.1922,
    logse = 0.2551,
    total = NA,
    event = NA,
    hr = 1.21,
    lower = 0.74,
    upper = 2.00) %>%  
  add_row(.before = 1) %>%
  mutate(
    group = "Hispanic"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Hispanic",
      TRUE ~ ""
    )
  )
```

### Asian  
```{r analysis_09 ma mss asian ukb}
ma_mss_asian <- ma_mss %>%
  filter(subgroup == "asian" & cohort != "chs") 

res_mss_asian <- rma(loghr, sei = logse, data = ma_mss_asian, method = "FE")
summary(res_mss_asian)
metafor::forest(res_mss_asian, 
                slab = paste0(ma_mss_asian$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_mss_asian_re <- ma_mss_asian %>%
  add_row(
    cohort = "summary", 
    subgroup = "asian", 
    loghr = 0.5892,
    logse = 0.1924,
    total = NA,
    event = NA,
    hr = 1.80,
    lower = 1.24,
    upper = 2.63) %>%  
  add_row(.before = 1) %>%
  mutate(
    group = "Asian"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Asian",
      TRUE ~ ""
    )
  )
```

### Combined  
```{r analysis_09 ma mss combined ukb, fig.width=7.5, fig.height=7.5}
ma_mss_combined <- bind_rows(ma_mss_white_re, ma_mss_black_re, ma_mss_hispanic_re, ma_mss_asian_re) 

ma_mss_combined %<>%
  mutate(
    lci = loghr - 1.96*logse, 
    uci = loghr + 1.96*logse,
    ` ` = paste(rep(" ", 30), collapse = ""),
    `HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr, lower, upper),
    total = as.character(total),
    event = as.character(event)
  ) %>%
  mutate(
    cohort = case_when(
      row == 1 ~ "",
      cohort == "aric" ~ "ARIC",
      cohort == "mesa" ~ "MESA",
      cohort == "fhs" ~ "FHS",
      cohort == "chs" ~ "CHS",
      cohort == "whi" ~ "WHI",  
      cohort == "ukb" ~ "UKB", 
      cohort == "summary" ~ "Summary"
    ),
    `HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `HR (95% CI)`
    ),
    total = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ total
    ),
    event = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ event
    )
  ) %>%
  dplyr::select(group, cohort, total, event, ` `, `HR (95% CI)`, everything()) %>%
  rename(
    Total = total,
    Events = event,
    Group = group,
    Cohort = cohort
  )

mss_combined <- forestploter::forest(
  ma_mss_combined[, c(1:6)],
  est = ma_mss_combined$hr, 
  lower = ma_mss_combined$lower,
  upper = ma_mss_combined$upper,
  sizes = 0.6,
  ci_column = 5,
  ref_line = 1,
  x_trans = "log",
  title = "MSS"
  )  

mss_combined_plot <- edit_plot(
  mss_combined,
  row = c(7, 13, 17, 22),
  col = 5, 
  which = "ci",
  gp = grid::gpar(col = "blue"))


mss_race_a <- edit_plot(mss_combined_plot,
          row = c(7, 13, 17, 22),
          gp = grid::gpar(fontface = "bold"))
mss_race_a
```

## Heteroplasmy count and Mitoscore  
### White 
```{r analysis_09 ma hc_mss white ukb}
ma_hc_mss_white <- ma_hc_mss %>%
  filter(subgroup == "white" & cohort != "chs") 

# coefficients for het_count
res_hc_mss_white_hc <- rma(loghr_hc, sei = logse_hc, data = ma_hc_mss_white, method = "FE")
summary(res_hc_mss_white_hc)
metafor::forest(res_hc_mss_white_hc, 
                slab = paste0(ma_hc_mss_white$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

# coefficients for mss 
res_hc_mss_white_mss <- rma(loghr_mss, sei = logse_mss, data = ma_hc_mss_white, method = "FE")
summary(res_hc_mss_white_mss)
metafor::forest(res_hc_mss_white_mss, 
                slab = paste0(ma_hc_mss_white$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_mss_white_re <- ma_hc_mss_white %>%
  add_row(
    cohort = "summary", 
    subgroup = "white", 
    loghr_hc = 0.0013,
    logse_hc = 0.0116,
    loghr_mss = 0.1761,
    logse_mss = 0.0318,
    total = NA,
    event = NA,
    hr_hc = 1.00,
    lower_hc = 0.98,
    upper_hc = 1.02,
    hr_mss = 1.19,
    lower_mss = 1.12,
    upper_mss = 1.27) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "white"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "White",
      TRUE ~ ""
    )
  )
```

### Black  
```{r analysis_09 ma hc_mss black ukb}
ma_hc_mss_black <- ma_hc_mss %>%
  filter(subgroup == "black" & cohort != "chs") 

# coefficients for het_count
res_hc_mss_black_hc <- rma(loghr_hc, sei = logse_hc, data = ma_hc_mss_black, method = "FE")
summary(res_hc_mss_black_hc)
metafor::forest(res_hc_mss_black_hc, 
                slab = paste0(ma_hc_mss_black$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

# coeffiients for mss
res_hc_mss_black_mss <- rma(loghr_mss, sei = logse_mss, data = ma_hc_mss_black, method = "FE")
summary(res_hc_mss_black_mss)
metafor::forest(res_hc_mss_black_mss, 
                slab = paste0(ma_hc_mss_black$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_mss_black_re <- ma_hc_mss_black %>%
  add_row(
    cohort = "summary", 
    subgroup = "black", 
    loghr_hc = 0.0794,
    logse_hc = 0.0380,
    loghr_mss = -0.1554,
    logse_mss = 0.1083,
    total = NA,
    event = NA,
    hr_hc = 1.08,
    lower_hc = 1.00,
    upper_hc = 1.17,
    hr_mss = 0.86,
    lower_mss = 0.69,
    upper_mss = 1.06) %>%
  add_row(.before = 1) %>%
  mutate(
    group = "Black"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Black",
      TRUE ~ ""
    )
  )
```

### Hispanic  
```{r analysis_09 ma hc_mss hispanic ukb}
ma_hc_mss_hispanic <- ma_hc_mss %>%
  filter(subgroup == "hispanic" & cohort != "chs") 

# coefficients for het_count
res_hc_mss_hispanic_hc <- rma(loghr_hc, sei = logse_hc, data = ma_hc_mss_hispanic, method = "FE")
summary(res_hc_mss_hispanic_hc)
metafor::forest(res_hc_mss_hispanic_hc, 
                slab = paste0(ma_hc_mss_hispanic$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

# coeffiients for mss
res_hc_mss_hispanic_mss <- rma(loghr_mss, sei = logse_mss, data = ma_hc_mss_hispanic, method = "FE")
summary(res_hc_mss_hispanic_mss)
metafor::forest(res_hc_mss_hispanic_mss, 
                slab = paste0(ma_hc_mss_hispanic$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_mss_hispanic_re <- ma_hc_mss_hispanic %>%
  add_row(
    cohort = "summary", 
    subgroup = "hispanic", 
    loghr_hc = 0.0274,
    logse_hc = 0.1141,
    loghr_mss = 0.1012,
    logse_mss = 0.3422,
    total = NA,
    event = NA,
    hr_hc = 1.03,
    lower_hc = 0.82,
    upper_hc = 1.29,
    hr_mss = 1.11,
    lower_mss = 0.57,
    upper_mss = 2.16) %>%  
  add_row(.before = 1) %>%
  mutate(
    group = "Hispanic"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Hispanic",
      TRUE ~ ""
    )
  )
```

### Asian  
```{r analysis_09 ma hc_mss asian ukb}
ma_hc_mss_asian <- ma_hc_mss %>%
  filter(subgroup == "asian" & cohort != "chs") 

# coefficients for het_count
res_hc_mss_asian_hc <- rma(loghr_hc, sei = logse_hc, data = ma_hc_mss_asian, method = "FE")
summary(res_hc_mss_asian_hc)
metafor::forest(res_hc_mss_asian_hc, 
                slab = paste0(ma_hc_mss_asian$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

# coeffiients for mss
res_hc_mss_asian_mss <- rma(loghr_mss, sei = logse_mss, data = ma_hc_mss_asian, method = "FE")
summary(res_hc_mss_asian_mss)
metafor::forest(res_hc_mss_asian_mss, 
                slab = paste0(ma_hc_mss_asian$cohort),
                atransf = exp,
                header = TRUE,
                showweights = TRUE)

ma_hc_mss_asian_re <- ma_hc_mss_asian %>%
  add_row(
    cohort = "summary", 
    subgroup = "asian", 
    loghr_hc = 0.0758,
    logse_hc = 0.1003,
    loghr_mss = 0.4271,
    logse_mss = 0.2783,
    total = NA,
    event = NA,
    hr_hc = 1.08,
    lower_hc = 0.89,
    upper_hc = 1.31,
    hr_mss = 1.53,
    lower_mss = 0.89,
    upper_mss = 2.64) %>%   
  add_row(.before = 1) %>%
  mutate(
    group = "Asian"
  ) %>%
  dplyr::select(group, cohort, everything()) %>%
  dplyr::select(-subgroup) %>%
  mutate(
    row = row_number()
  ) %>%
  mutate(
    group = case_when(
      row == 1 ~ "Asian",
      TRUE ~ ""
    )
  )
```

### Combined  
```{r analysis_09 ma hc_mss combined ukb, fig.width=12, fig.height=8}
ma_hc_mss_combined <- bind_rows(ma_hc_mss_white_re, ma_hc_mss_black_re, ma_hc_mss_hispanic_re, ma_hc_mss_asian_re) 

ma_hc_mss_combined %<>%
  mutate(
    # estimates for het_count
    lci_hc = loghr_hc - 1.96*logse_hc, 
    uci_hc = loghr_hc + 1.96*logse_hc,
    hc = paste(rep(" ", 30), collapse = ""),
    `Heteroplasmy count HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr_hc, lower_hc, upper_hc),
    # estimates for mss
    lci_mss = loghr_mss - 1.96*logse_mss, 
    uci_mss = loghr_mss + 1.96*logse_mss,
    mss = paste(rep(" ", 30), collapse = ""),
    `MSS HR (95% CI)` = sprintf("%.2f (%.2f to %.2f)", hr_mss, lower_mss, upper_mss),
    total = as.character(total),
    event = as.character(event)
  ) %>%
  mutate(
    cohort = case_when(
      row == 1 ~ "",
      cohort == "aric" ~ "ARIC",
      cohort == "mesa" ~ "MESA",
      cohort == "fhs" ~ "FHS",
      cohort == "chs" ~ "CHS",
      cohort == "whi" ~ "WHI",      
      cohort == "ukb" ~ "UKB", 
      cohort == "summary" ~ "Summary"
    ),
    `Heteroplasmy count HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `Heteroplasmy count HR (95% CI)`
    ),
    `MSS HR (95% CI)` = case_when(
      row == 1 ~ "",
      TRUE ~ `MSS HR (95% CI)`
    ),
    total = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ total
    ),
    event = case_when(
      row == 1 | cohort == "Summary" ~ "",
      TRUE ~ event
    )
  ) %>%
  dplyr::select(group, cohort, total, event, hc, `Heteroplasmy count HR (95% CI)`, mss, `MSS HR (95% CI)`, everything()) %>%
  rename(
    Total = total,
    Events = event,
    Group = group,
    Cohort = cohort, 
    ` ` = hc,
    `  ` = mss
  )

hc_mss_combined <- forestploter::forest(
  ma_hc_mss_combined[, c(1:8)],
  est = list(ma_hc_mss_combined$hr_hc, ma_hc_mss_combined$hr_mss), 
  lower = list(ma_hc_mss_combined$lower_hc, ma_hc_mss_combined$lower_mss),
  upper = list(ma_hc_mss_combined$upper_hc, ma_hc_mss_combined$upper_mss),
  sizes = 0.6,
  ci_column = c(5, 7),
  ref_line = c(1, 1),
  x_trans = "log",
  title = "Heterplasmy count and MSS"
  )  

hc_mss_combined_plot <- edit_plot(
  hc_mss_combined,
  row = c(7, 13, 17, 22),
  col = c(5, 7), 
  which = "ci",
  gp = grid::gpar(col = "blue"))


hc_mss_race_a <- edit_plot(hc_mss_combined_plot,
          row = c(7, 13, 17, 22),
          gp = grid::gpar(fontface = "bold"))
hc_mss_race_a
```

```{r, fig.height = 15, fig.width = 15}
combined_all <- ggpubr::ggarrange(
  ggpubr::ggarrange(hc_race_a, mss_race_a, nrow = 1, labels = c("a", "b")), 
  hc_mss_race_a,
  nrow = 2, 
  labels = c("", "c"),
  widths = c(1, 1)
)
ggsave("ukb_heteroplasmy_outcomes_extended_fig8.tiff", combined_all)
```


